---
title: "Navicore POC Workbook"
author: ejs
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: false
  pdf_document:
    toc: true
    number_sections: true
    highlight: haddock
fontsize: 12pt
geometry: margin=.5in
---

HOWTO
========

###Pull data

save files in data dir


###Create report

```
./build.sh
```

At this point, you are done.  Find the final pdf report generated by the
`build.sh` script in the root dir of this repository.

If the report requires further explanation, read on...

Load Data
========

The JSON data is loaded into a dataframe ...

```{r load, fig.width=7, fig.height=7, message=FALSE, echo=FALSE}
library(stringi)
library(ggthemes)
library(here)
library(jsonlite)
library(knitr)
library(tidyverse)

myData <- read.csv("./data/data.csv", header = TRUE, sep = ",", strip.white=TRUE)
myRef <- read.csv("./data/ref.csv", header = TRUE, sep = ",", strip.white=TRUE)

updatedDf <- myData %>%
  pmap_dfr(function(...) {
    current <- tibble(...)
    cols <- current %>% select(starts_with("Sprint"))
    cols <- unlist(cols[1, ], use.names = FALSE)
    cols <- stri_remove_empty_na(cols)
    current$ActualSprint <- tail(cols, n=1)
    current
})

updatedDf

enriched <- merge(updatedDf, myRef, by.x="Reporter", by.y="username", all.x=TRUE)
enriched$Reporter <- as.factor(enriched$Reporter)
enriched$ActualSprint <- as.factor(enriched$ActualSprint)

kable(summary(enriched)[,1:3])
kable(enriched[c(1,8)])
kable(enriched)
kable(enriched[c(c(8),2,7)])


```

